function doGet(e) {
  const MAX_PARTICIPANTES = 75;
  const ss = SpreadsheetApp.openById("COLOQUE_AQUI_O_ID_DA_PLANILHA");
  const sheet = ss.getSheetByName("Página1");

  const total = sheet.getLastRow() - 1; // desconta cabeçalho
  const vagasRestantes = MAX_PARTICIPANTES - total;

  return ContentService.createTextOutput(
    JSON.stringify({ total, vagasRestantes })
  ).setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  const MAX_PARTICIPANTES = 75;
  const ss = SpreadsheetApp.openById("COLOQUE_AQUI_O_ID_DA_PLANILHA");
  const sheet = ss.getSheetByName("Página1");

  const nome = e.parameter.nome;
  const telefone = e.parameter.telefone;

  // Verifica duplicados
  const dados = sheet.getDataRange().getValues();
  for (let i = 1; i < dados.length; i++) {
    if (dados[i][0] == nome || dados[i][1] == telefone) {
      return ContentService.createTextOutput(JSON.stringify({ erro: "duplicado" }))
        .setMimeType(ContentService.MimeType.JSON);
    }
  }

  // Adiciona nova linha
  sheet.appendRow([nome, telefone]);

  const total = sheet.getLastRow() - 1;
  const vagasRestantes = MAX_PARTICIPANTES - total;

  return ContentService.createTextOutput(
    JSON.stringify({ sucesso: true, total, vagasRestantes })
  ).setMimeType(ContentService.MimeType.JSON);
}
