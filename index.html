<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRILHA MORRO DA MESA - 23 DE NOVEMBRO</title>
<style>
  body {
    background-color: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
  }
  h1 {
    font-size: 26px;
    color: #00ffcc;
    margin-bottom: 20px;
  }
  form {
    background-color: #111;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    margin: 0 auto;
    box-shadow: 0 0 10px #00ffcc;
  }
  input[type="text"] {
    width: 90%;
    padding: 10px;
    margin: 10px 0;
    border: none;
    border-radius: 5px;
  }
  button {
    background-color: #00ffcc;
    border: none;
    padding: 10px 20px;
    color: #000;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #00ffaa;
  }
  #contador {
    font-size: 18px;
    margin-top: 15px;
  }
</style>
</head>
<body>

<h1>TRILHA MORRO DA MESA - 23 DE NOVEMBRO</h1>
<p>Preencha seu nome e confirme o termo de responsabilidade para garantir sua vaga.</p>

<form id="reservaForm">
  <input type="text" id="nome" name="nome" placeholder="Digite seu nome completo" required><br>

  <label>
    <input type="checkbox" id="aceite" required>
    Li e aceito o <a href="#" style="color:#00ffcc;">Termo de Responsabilidade</a>
  </label><br><br>

  <button type="submit">Confirmar e Entrar no Grupo</button>
</form>

<p id="contador">Carregando vagas...</p>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbx2eQenBBxT1vR3mD65XOv_4Y0GUIjVt3pLt8ISJl43dGTFC57Ljl6T4XzOYXIk__Gx/exec';
  const form = document.getElementById('reservaForm');
  const contador = document.getElementById('contador');
  const linkGrupo = 'https://chat.whatsapp.com/'; // coloque o link do grupo

  async function carregarVagas() {
    try {
      const response = await fetch(scriptURL + '?action=contagem');
      const data = await response.json();
      contador.textContent = `Vagas disponíveis: ${data.vagas || 'N/D'}`;
    } catch (e) {
      contador.textContent = 'Não foi possível carregar as vagas.';
    }
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const nome = document.getElementById('nome').value;
    const aceite = document.getElementById('aceite').checked;

    if (!aceite) {
      alert('É necessário aceitar o termo de responsabilidade.');
      return;
    }

    fetch(scriptURL, {
      method: 'POST',
      body: new FormData(form)
    })
    .then(() => {
      alert('Cadastro confirmado! Agora entre no grupo do WhatsApp.');
      window.location.href = linkGrupo;
    })
    .catch(error => alert('Erro ao enviar. Tente novamente.'));
  });

  carregarVagas();
</script>

</body>
</html>
