<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trilha Morro da Mesa – 23 de Novembro</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  .container {
    max-width: 700px;
    margin: 0 auto;
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h1 {
    text-align: center;
    color: #008037;
    margin-bottom: 10px;
  }
  .sub {
    text-align: center;
    margin-bottom: 25px;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 10px;
  }
  input, textarea, button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
  button {
    background-color: #008037;
    color: white;
    border: none;
    cursor: pointer;
    font-size: 16px;
    margin-top: 15px;
  }
  button:hover {
    background-color: #006b2c;
  }
  .contador {
    text-align: center;
    background: #e8f5e9;
    border: 1px solid #b2dfdb;
    padding: 10px;
    border-radius: 5px;
    margin-top: 15px;
    font-weight: bold;
  }
  .fechado {
    color: red;
    text-align: center;
    font-weight: bold;
    margin-top: 15px;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>TRILHA MORRO DA MESA</h1>
    <div class="sub">23 de Novembro</div>

    <p><strong>Termo de Ciência e Responsabilidade – Trilheiros de Rondonópolis</strong></p>
    <p>Leia com atenção as informações abaixo. Ao preencher este formulário, você declara que está ciente, concorda e assume total responsabilidade pela sua participação.</p>
    <ul>
      <li>O percurso tem nível médio a avançado, com trechos íngremes e escorregadios.</li>
      <li>É obrigatório o uso de calçados adequados, água, protetor solar e roupas confortáveis.</li>
      <li>É proibido o uso de caixas de som para preservar o ambiente.</li>
      <li>O participante deve respeitar a natureza, não deixar lixo e seguir as orientações do guia.</li>
      <li>A organização não se responsabiliza por acidentes causados por imprudência ou desrespeito às regras.</li>
      <li>Em caso de condições climáticas adversas, o passeio poderá ser cancelado ou adiado.</li>
      <li>É indispensável estar em boas condições de saúde para participar da trilha.</li>
      <li>Pessoas com problemas cardíacos, respiratórios, mobilidade reduzida ou histórico de desmaios/síncopes não devem participar.</li>
      <li>Participantes sedentários ou sem preparo físico devem avaliar cuidadosamente os riscos.</li>
      <li>Crianças menores de 14 anos não são permitidas.</li>
    </ul>
    <p><strong>Declaração:</strong> Eu, abaixo assinado, declaro que participarei da trilha por minha livre e espontânea vontade, estou ciente dos riscos envolvidos e isento os organizadores de qualquer responsabilidade por acidentes decorrentes da atividade, exceto em casos de comprovada negligência. Declaro também que estou em condições físicas adequadas para a prática da atividade.</p>

    <form id="termoForm">
      <label>Nome completo:</label>
      <input type="text" id="nome" name="nome" required>

      <label>WhatsApp:</label>
      <input type="text" id="whatsapp" name="whatsapp" required placeholder="(DDD) 9xxxx-xxxx">

      <label>
        <input type="checkbox" id="aceite" required>
        Li e aceito o termo de responsabilidade acima
      </label>

      <button type="submit">Confirmar e Entrar no Grupo</button>
    </form>

    <div class="contador" id="contador">Carregando vagas...</div>
    <div class="fechado" id="fechado" style="display:none;">Grupo fechado. Vagas esgotadas!</div>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx2eQenBBxT1vR3mD65XOv_4Y0GUIjVt3pLt8ISJl43dGTFC57Ljl6T4XzOYXIk__Gx/exec';
    const form = document.getElementById('termoForm');
    const contadorEl = document.getElementById('contador');
    const fechadoEl = document.getElementById('fechado');
    const limite = 75;

    async function atualizarContador() {
      try {
        const res = await fetch(scriptURL + '?contagem=true');
        const data = await res.json();
        const total = data.total || 0;
        const restantes = limite - total;
        contadorEl.textContent = `Vagas disponíveis: ${restantes > 0 ? restantes : 0}`;
        if (total >= limite) {
          form.style.display = 'none';
          fechadoEl.style.display = 'block';
        }
      } catch (e) {
        contadorEl.textContent = 'Erro ao carregar vagas.';
      }
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .then(() => {
          window.location.href = "https://chat.whatsapp.com/GOReIoh8N0ZCa4pQh2IMy7";
        })
        .catch(() => alert('Erro ao enviar. Tente novamente.'));
    });

    atualizarContador();
    setInterval(atualizarContador, 10000);
  </script>
</body>
</html>
