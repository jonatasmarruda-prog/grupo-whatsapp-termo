<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MORRO DA MESA — 23 DE NOVEMBRO</title>

<style>
:root{
    --bg: #05060a;
    --panel: #0f1620;
    --muted: #bfc9d9;
    --blue: #4da8ff;
    --blue-soft: rgba(77,168,255,0.12);
    --glass: rgba(255,255,255,0.03);
}

html,body{
    height:100%;
    margin:0;
    font-family: "Inter", "Roboto", Arial, sans-serif;
    background: linear-gradient(180deg, #030406 0%, var(--bg) 100%);
    color: #e8f0ff;
    font-size:16px;
}

.wrap{
    max-width:720px;
    margin:20px auto;
    padding:22px;
}

.card{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), var(--panel));
    border-radius:14px;
    padding:20px;
    box-shadow: 0 8px 36px rgba(24,40,80,0.45), 0 0 28px rgba(77,168,255,0.06) inset;
    border: 1px solid rgba(77,168,255,0.10);
}

h1{
    font-size:2.4rem;
    margin:6px 0 4px 0;
    text-align:center;
    color:var(--blue);
    letter-spacing:2px;
    font-weight:800;
    text-transform:uppercase;
    text-shadow: 0 4px 22px rgba(77,168,255,0.3);
}

h2{
    font-size:1rem;
    text-align:center;
    color:var(--muted);
    margin:0 0 18px 0;
    font-weight:600;
}

/* Contador de vagas */
.vagasBox{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    padding:12px;
    border-radius:10px;
    background: linear-gradient(180deg, rgba(77,168,255,0.02), transparent);
    border: 1px solid rgba(77,168,255,0.08);
    color:var(--blue);
    font-weight:700;
    margin-bottom:14px;
    box-shadow: 0 6px 18px rgba(77,168,255,0.04);
}

.vagasBox span.count{
    font-size:1.05rem;
    color:#e6f4ff;
    background:var(--blue-soft);
    padding:6px 10px;
    border-radius:8px;
    font-weight:800;
    border: 1px solid rgba(77,168,255,0.08);
}

/* Termo */
.termo{
    background:var(--glass);
    border-radius:10px;
    padding:14px;
    height:280px;
    overflow:auto;
    color:#dbe9ff;
    line-height:1.7;
    border: 1px solid rgba(255,255,255,0.03);
    margin-bottom:14px;
}

.termo p{
    margin:12px 0;
}

/* Input nome */
input#nome{
    width:100%;
    padding:12px;
    font-size:1rem;
    border-radius:10px;
    border:1px solid rgba(77,168,255,0.3);
    margin-bottom:12px;
    background:#111827;
    color:#e8f0ff;
}

/* Checkbox */
label.checkbox{
    display:flex;
    gap:12px;
    align-items:center;
    cursor:pointer;
    color:var(--muted);
    font-weight:600;
}

input[type="checkbox"]{
    width:20px;
    height:20px;
    accent-color: var(--blue);
    transform:scale(1.05);
}

/* Botão */
.btn{
    display:block;
    width:100%;
    padding:14px 16px;
    border-radius:12px;
    text-align:center;
    font-weight:800;
    font-size:1.05rem;
    cursor:pointer;
    border:none;
    transition: transform .12s ease, box-shadow .15s ease, opacity .12s ease;
}

.btn-entrar{
    background: linear-gradient(180deg, var(--blue), #1b71c8);
    color:#021022;
    box-shadow: 0 10px 30px rgba(29,94,165,0.22), 0 0 28px rgba(77,168,255,0.14);
    display:none;
}

.btn-entrar:active{
    transform: translateY(1px) scale(.998);
}

/* Lotado */
.lotado{
    display:none;
    margin-top:12px;
    padding:12px;
    border-radius:10px;
    background: linear-gradient(180deg, #00005f, #0040a8);
    color:#00ffff;
    text-align:center;
    font-weight:900;
    font-size:1.3rem;
    text-transform:uppercase;
    text-shadow: 0 0 12px #00ffff;
}

/* Responsividade */
@media (max-width:420px){
    .wrap{ padding:12px; }
    h1{ font-size:1.8rem; }
    .termo{ height:240px; padding:12px; font-size:0.98rem; }
    .vagasBox{ font-size:0.95rem; padding:10px; }
}
</style>
</head>
<body>
<div class="wrap">
<div class="card">
  <h1>Morro da Mesa</h1>
  <h2>23 de novembro — Trilheiros de Rondonópolis</h2>

  <div class="vagasBox">
      <div>Vagas disponíveis</div>
      <div><span id="vagasNum" class="count">—</span> / 75</div>
  </div>

  <div id="lotado" class="lotado">GRUPO LOTADO</div>

  <div class="termo">
      <p>- O percurso tem nível médio a avançado. Há trechos íngremes e com risco de escorregar.</p>
      <p>- É obrigatório usar calçado adequado. Leve água, protetor solar e roupas confortáveis.</p>
      <p>- Caixa de som não é permitida. Preserve a natureza e o ambiente.</p>
      <p>- Cada participante deve manter o local limpo e seguir orientações do guia.</p>
      <p>- A organização não assume responsabilidade por acidentes por imprudência.</p>
      <p>- Em caso de clima desfavorável o passeio poderá ser cancelado ou adiado.</p>
      <p>- É necessário estar em boas condições de saúde para participar.</p>
      <p>- Pessoas com problemas cardíacos, respiratórios ou histórico de desmaio não devem fazer esta atividade.</p>
      <p>- Participantes sedentários devem avaliar os riscos antes de confirmar.</p>
      <p>- Crianças menores de 14 anos não podem participar.</p>
  </div>

  <input type="text" id="nome" placeholder="Digite seu nome completo">

  <label class="checkbox">
    <input type="checkbox" id="aceite">
    Confirmo que li e aceito o termo de responsabilidade
  </label>

  <button class="btn btn-entrar" id="btnEntrar">Clica aqui para entrar no grupo</button>

</div>
</div>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz9m_YrXZ3pCNTsqnBX9XuNuTIINjQ0ErPpmkUyU9FkkYKv9bI5fWP2w93Ui9VjA1hs8Q/exec";
const WHATSAPP_LINK = "https://chat.whatsapp.com/GOReIoh8N0ZCa4pQh2IMy7";
const MAX_VAGAS = 75;

const vagasNumEl = document.getElementById("vagasNum");
const lotadoEl = document.getElementById("lotado");
const aceiteEl = document.getElementById("aceite");
const btnEntrar = document.getElementById("btnEntrar");
const nomeInput = document.getElementById("nome");

// Atualiza interface quando lotado
function atualizarVagas(vagas){
  if(vagas <= 0){
    lotadoEl.style.display = "block";
    vagasNumEl.textContent = 0;
    aceiteEl.disabled = true;
    btnEntrar.style.display = "none";
  } else {
    lotadoEl.style.display = "none";
    aceiteEl.disabled = false;
    vagasNumEl.textContent = vagas;
  }
}

// Busca vagas do Apps Script
async function carregarVagas(){
  try{
    const res = await fetch(APPS_SCRIPT_URL, {cache:"no-cache"});
    const data = await res.json();
    let vagas = Number(data.vagas);
    if(isNaN(vagas)) vagas = MAX_VAGAS;
    atualizarVagas(vagas);
  }catch(e){
    vagasNumEl.textContent = "—";
    console.error("Erro ao buscar vagas",e);
  }
}

// Habilita botão apenas quando nome preenchido e aceite marcado
function verificarForm(){
  if(nomeInput.value.trim() !== "" && aceiteEl.checked && Number(vagasNumEl.textContent) > 0){
    btnEntrar.style.display = "block";
  } else {
    btnEntrar.style.display = "none";
  }
}

nomeInput.addEventListener("input", verificarForm);
aceiteEl.addEventListener("change", verificarForm);

btnEntrar.addEventListener("click", async ()=>{
  // envia nome para Apps Script (opcional, pode gravar no Sheet)
  const nome = nomeInput.value.trim();
  if(nome === "") return;

  try{
    await fetch(APPS_SCRIPT_URL + "?nome=" + encodeURIComponent(nome));
  }catch(e){ console.log("Erro enviar nome",e); }

  // decrementa localmente (apenas visual)
  let vagas = Number(vagasNumEl.textContent) - 1;
  atualizarVagas(vagas);

  // redireciona para WhatsApp
  window.location.href = WHATSAPP_LINK;
});

// Atualiza contador a cada 6s
carregarVagas();
setInterval(carregarVagas,6000);
</script>
</body>
</html>
